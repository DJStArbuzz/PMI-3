<h1 name="content" align="center"><a href=""><img src="https://github.com/user-attachments/assets/e080adec-6af7-4bd2-b232-d43cb37024ac" width="20" height="20"/></a> MSSQL</h1>

<p align="center">
  <a href="#-lab1"><img alt="lab1" src="https://img.shields.io/badge/Lab1-blue"></a> 
  <a href="#-lab2"><img alt="lab2" src="https://img.shields.io/badge/Lab2-red"></a>
  <a href="#-lab3"><img alt="lab3" src="https://img.shields.io/badge/Lab3-green"></a>
  <a href="#-lab4"><img alt="lab4" src="https://img.shields.io/badge/Lab4-yellow"></a>
  <a href="#-lab5"><img alt="lab5" src="https://img.shields.io/badge/Lab5-gray"></a>
  <a href="#-lab6"><img alt="lab6" src="https://img.shields.io/badge/Lab6-orange"></a> 
  <a href="#-lab7"><img alt="lab7" src="https://img.shields.io/badge/Lab7-brown"></a>
  <a href="#-lab8"><img alt="lab8" src="https://img.shields.io/badge/Lab8-purple"></a>
  <a href="#-lab9"><img alt="lab9" src="https://img.shields.io/badge/Lab9-violet"></a> 
</p>

<img src="https://github.com/user-attachments/assets/e080adec-6af7-4bd2-b232-d43cb37024ac" width="20" height="20"/> Регистратура поликлиники – вызовы на дом (Вариант №3)
<p aligh="justify>
<h3>
  <a href="#client"></a>

  Информация о терапевтах: ФИО, телефон, номер кабинета, номер участка.
  Информация об адресах: номер участка, название улицы, список домов.
  Информация о вызовах: ФИО пациента, адрес, дата, время обращения, диагноз (выставляемый
после посещения пациента врачом).
  Реализовать:
- Вывод данных для участка о количестве пациентов, вызывавших врача за заданный период;
- Вычисление номера участка больного на основании адреса;
- Вывод данных для участка о количестве вызовов за заданный период;
- Вывод для терапевта списка пациентов, ожидающих посещения врача;
- Вывод по каждому диагнозу количества пациентов за заданный период.
</h3>
</p>
# <img src="https://github.com/user-attachments/assets/e080adec-6af7-4bd2-b232-d43cb37024ac" width="20" height="20"/> Lab1 Лабораторная работа №1


<p aligh="justify>
<h3>
  <a href="#client"></a>
  Разработать ER-модель данной предметной области: выделить сущности, их атрибуты,
связи между сущностями.
Для каждой сущности указать ее имя, атрибут (или набор атрибутов), являющийся
первичным ключом, список остальных атрибутов.
Для каждого атрибута указать его тип, ограничения, может ли он быть пустым, является ли
он первичным ключом.
Для каждой связи между сущностями указать:
- тип связи (1:1, 1:M, M:N)
- обязательность
ER-модель д.б. представлена в виде ER-диаграммы (картинка)
По имеющейся ER-модели создать реляционную модель данных и отобразить ее в виде
списка сущностей с их атрибутами и типами атрибутов, для атрибутов указать, явл. ли он
первичным или внешним ключом
</h3>
</p3>

ER-модель Поликлиники
![image](https://github.com/DJStArbuzz/PMI-3/blob/main/lab1/1.png)


Реляционная модель
![image](https://github.com/DJStArbuzz/PMI-3/blob/main/lab1/2.png)
# <img src="https://github.com/user-attachments/assets/e080adec-6af7-4bd2-b232-d43cb37024ac" width="20" height="20"/> Лабораторная работа №2

<p aligh="justify>
<h3>
  <a href="#client"></a>
В соответствии с реляционной моделью данных, разработанной в Лаб.№1, создать реляционную БД на учебном сервере БД :
- создать таблицы, определить первичные ключи и иные ограничения
- определить связи между таблицами
- создать диаграмму
- заполнить все таблицы адекватной информацией (не меньше 10 записей в таблицах, наличие примеров для связей типа 1:M )

</h3>
</p3>

![image](https://github.com/DJStArbuzz/PMI-3/blob/main/lab2/main.png)
![image](https://github.com/DJStArbuzz/PMI-3/blob/main/lab2/diagram.png)
Пример заполненной таблицы "Пациенты":
![image](https://github.com/DJStArbuzz/PMI-3/blob/main/lab2/main2.png)
```
-- Таблица Участок
CREATE TABLE District (
    id BIGINT PRIMARY KEY IDENTITY(1,1),
    district_number BIGINT NOT NULL UNIQUE,
    streets NVARCHAR(MAX) NOT NULL  
);

-- Таблица Диагноз
CREATE TABLE Diagnosis (
    id BIGINT PRIMARY KEY IDENTITY(1,1),
    name NVARCHAR(100) NOT NULL UNIQUE,
    description NVARCHAR(MAX)
);

-- Таблица Пациент
CREATE TABLE Patient (
    id BIGINT PRIMARY KEY IDENTITY(1,1),
    full_name NVARCHAR(100) NOT NULL,
    street NVARCHAR(100) NOT NULL,
    house_number BIGINT NOT NULL,
    district_id BIGINT REFERENCES District(id) ON DELETE SET NULL
);

-- Таблица Терапевт
CREATE TABLE Therapist (
    id BIGINT PRIMARY KEY IDENTITY(1,1),
    full_name NVARCHAR(100) NOT NULL,
    phone NVARCHAR(50) NOT NULL,  
    office_number BIGINT NOT NULL,
    district_id BIGINT REFERENCES District(id) ON DELETE SET NULL
);

-- Таблица График работы (Расписание терапевта)
CREATE TABLE Therapist_schedule (
    id BIGINT PRIMARY KEY IDENTITY(1,1),
    therapist_id BIGINT REFERENCES Therapist(id) ON DELETE CASCADE,
    day_of_week SMALLINT NOT NULL CHECK (day_of_week BETWEEN 1 AND 7),
    start_time TIME NOT NULL,
    end_time TIME NOT NULL
);

-- Таблица Вызов
CREATE TABLE Call (
    id BIGINT PRIMARY KEY IDENTITY(1,1),
    appeal_date DATE NOT NULL,
    start_time TIME NOT NULL,
    end_time TIME,
    visit_status BIT NOT NULL DEFAULT 0,
    patient_id BIGINT REFERENCES Patient(id) ON DELETE CASCADE,
    therapist_id BIGINT REFERENCES Therapist(id) ON DELETE SET NULL
);

-- Таблица Вызов-диагноз
CREATE TABLE Call_diagnosis (
    diagnosis_id BIGINT REFERENCES Diagnosis(id) ON DELETE CASCADE,
    call_id BIGINT REFERENCES Call(id) ON DELETE CASCADE,
    doctor_comment NVARCHAR(MAX),
    PRIMARY KEY (diagnosis_id, call_id)
);


INSERT INTO District (district_number, streets) VALUES
(1, N'Улица Ленина, Улица Мира, Улица Гагарина'),
(2, N'Улица Пушкина, Улица Чехова, Улица Толстого'),
(3, N'Улица Советская, Улица Кирова, Улица Карла Маркса'),
(4, N'Улица Садовая, Улица Цветочная, Улица Парковая');


INSERT INTO Diagnosis (name, description) VALUES
(N'ОРВИ', N'Острая респираторная вирусная инфекция'),
(N'Грипп', N'Острое инфекционное заболевание дыхательных путей'),
(N'Гипертония', N'Повышенное артериальное давление'),
(N'Сахарный диабет', N'Нарушение обмена веществ'),
(N'Бронхит', N'Воспаление бронхов'),
(N'Гастрит', N'Воспаление слизистой оболочки желудка'),
(N'Ангина', N'Острое инфекционное заболевание с поражением нёбных миндалин');

INSERT INTO Patient (full_name, street, house_number, district_id) VALUES
(N'Андрианова Анастасия Дмитриевна', N'Улица Ленина', 10, 1),
(N'Баикин Эдуард Александрович', N'Улица Мира', 25, 1),
(N'Быков Александр Владимирович', N'Улица Пушкина', 15, 2),
(N'Воробев Юрий Палович', N'Улица Чехова', 8, 2),
(N'Воробьева Мария Павловна', N'Улица Садовая', 12, 4),
(N'Жидков Никита Олегович', N'Улица Цветочная', 7, 4),
(N'Козина Анастасия Олеговна', N'Улица Парковая', 18, 4),
(N'Крылова Ксения Сергеевна', N'Улица Советская', 22, 3),
(N'Кудрявцев Вадим Вадимович', N'Улица Кирова', 5, 3),
(N'Кудряшов Никита Романович', N'Улица Карла Маркса', 14, 3),
(N'Лопаткин Даниил Евгеньевич', N'Улица Гагарина', 9, 1),
(N'Мерзун Иван Романович', N'Улица Ленина', 31, 1),
(N'Минаева Ксения Аркадьевна', N'Улица Мира', 17, 1),
(N'Немтинов Никита Сергеевич', N'Улица Пушкина', 4, 2),
(N'Петроченков Михаил Денисович', N'Улица Чехова', 11, 2),
(N'Пляскин Дмитрий Ефимович', N'Улица Садовая', 26, 4),
(N'Рахимова Регина Ильдаровна', N'Улица Цветочная', 3, 4),
(N'Рачинский Михаил Сергеевич', N'Улица Парковая', 19, 4),
(N'Родин Илья Алексеевич', N'Улица Советская', 8, 3),
(N'Родионов Никита Алексеевич', N'Улица Кирова', 13, 3),
(N'Никрашевич Егор Михайлович', N'Улица Карла Маркса', 7, 3),
(N'Середа Арсентий Станиславович', N'Улица Ленина', 42, 1),
(N'Тюменева Екатерина Андреевна', N'Улица Мира', 29, 1),
(N'Хрулев Иван Сергеевич', N'Улица Пушкина', 6, 2),
(N'Чернышова Мария Ивановна', N'Улица Чехова', 21, 2),
(N'Шебета Николай Иванович', N'Улица Садовая', 33, 4),
(N'Шипицын Денис Александрович', N'Улица Цветочная', 16, 4);

INSERT INTO Therapist (full_name, phone, office_number, district_id) VALUES
(N'Шебета Николай Иванович', N'+7-900-123-45-67', 101, 4),
(N'Вихарев Кирилл Алексеевич', N'+7-900-234-56-78', 102, 1),
(N'Семенов Евгений Николаевич', N'+7-900-345-67-89', 103, 2),
(N'Кудрявцев Матвей Владимирович', N'+7-900-456-78-90', 104, 3);

INSERT INTO Therapist_schedule (therapist_id, day_of_week, start_time, end_time) VALUES
(1, 1, '08:00', '16:00'),
(1, 2, '08:00', '16:00'),
(1, 3, '08:00', '16:00'),
(1, 4, '08:00', '16:00'),
(1, 5, '08:00', '16:00'),
(2, 1, '09:00', '17:00'),
(2, 3, '09:00', '17:00'),
(2, 5, '09:00', '17:00'),
(3, 2, '10:00', '18:00'),
(3, 4, '10:00', '18:00'),
(4, 1, '08:30', '16:30'),
(4, 2, '08:30', '16:30'),
(4, 4, '08:30', '16:30');

INSERT INTO Call (appeal_date, start_time, end_time, visit_status, patient_id, therapist_id) VALUES
('2024-01-15', '09:00', '09:30', 1, 1, 1),
('2024-01-15', '10:00', '10:30', 1, 3, 2),
('2024-01-16', '11:00', '11:30', 1, 5, 3),
('2024-01-16', '14:00', '14:30', 0, 7, 1),
('2024-01-17', '09:30', '10:00', 1, 9, 4),
('2024-01-17', '13:00', '13:30', 1, 11, 1),
('2024-01-18', '10:30', '11:00', 1, 13, 2),
('2024-01-18', '15:00', '15:30', 0, 15, 3),
('2024-01-19', '11:30', '12:00', 1, 17, 4),
('2024-01-19', '14:30', '15:00', 1, 19, 1),
('2024-01-22', '09:00', '09:30', 1, 21, 2),
('2024-01-22', '12:00', '12:30', 1, 23, 3),
('2024-01-23', '10:00', '10:30', 0, 25, 4),
('2024-01-23', '13:30', '14:00', 1, 27, 1);

INSERT INTO Call_diagnosis (diagnosis_id, call_id, doctor_comment) VALUES
(1, 1, N'Пациент жалуется на насморк и температуру'),
(2, 2, N'Высокая температура, ломота в теле'),
(3, 3, N'Повышенное давление 150/100'),
(1, 5, N'Кашель, боль в горле'),
(4, 6, N'Контроль уровня сахара'),
(5, 7, N'Сухой кашель, хрипы в легких'),
(6, 9, N'Боли в желудке после еды'),


(7, 10, N'Гнойная ангина, назначены антибиотики'),
(1, 11, N'Легкая простуда'),
(2, 12, N'Грипп, постельный режим'),
(3, 14, N'Гипертонический криз'); 
```
![image](/sources/yargu.png)

# <img src="https://github.com/user-attachments/assets/e080adec-6af7-4bd2-b232-d43cb37024ac" width="20" height="20"/> Лабораторная работа №3

<p aligh="justify>
<h3>
  <a href="#client"></a>
Часть 1
Цель: изучить конструкции языка SQL для манипулирования данными в СУБД  MSSQL.
Задания и краткое описание работы:
1. Выборка из одной таблицы.
1.1 Выбрать из произвольной таблицы данные и отсортировать их по двум  произвольным имеющимся в таблице признакам (разные направления сортировки).
1.2 Выбрать из произвольной таблицы те записи, которые удовлетворяют
условию отбора (where). Привести 2-3 запроса.
1.3 Привести примеры 2-3 запросов с использованием агрегатных функций
(count, max, sum и др.) с группировкой и без группировки. 
1.4  Привести примеры подведения подытога с использованием GROUP BY [ALL] [ CUBE | ROLLUP](2-3 запроса). В ROLLUP и CUBE использовать не менее 2-х столбцов.
1.5 Выбрать из таблиц информацию об объектах, в названиях которых нет заданной последовательности букв (LIKE).

2. Выборка из нескольких таблиц.
2.1 Вывести информацию подчиненной (дочерней) таблицы, заменяя коды
(значения внешних ключей) соответствующими символьными значениями из
родительских таблиц. Привести 2-3 запроса с использованием классического
подхода соединения таблиц (where).
2.2. Реализовать запросы пункта 2.1 через внутреннее соединение inner join. 
2.3. Левое внешнее соединение left join. Привести 2-3 запроса.
2.4. Правое внешнее соединение right join. Привести 2-3 запроса 
2.5. Привести примеры 2-3 запросов с использованием агрегатных функций
и группировки.
2.6. Привести примеры 2-3 запросов с использованием группировки и условия отбора групп (Having).
2.7. Привести примеры 3-4 вложенных (соотнесенных, c использованием IN, EXISTS) запросов.
3. Представления
3.1  На основе любых запросов из п. 2 создать два представления (VIEW).
3.2  Привести примеры использования общетабличных выражений (СТЕ) (2-3 запроса)
4. Функции ранжирования
4.1 Привести примеры 3-4 запросов с использованием ROW_NUMBER, RANK, DENSE_RANK (c  PARTITION BY и без)
5. Объдинение, пересечение, разность
5.1 Привести примеры 3-4 запросов с использованием UNION / UNION ALL, EXCEPT, INTERSECT. Данные  в одном из запросов отсортируйте по произвольному признаку.
6. Использование CASE, PIVOT и UNPIVOT.
6.1 Привести примеры получения сводных (итоговых) таблиц с использованием CASE
6.2 Привести примеры получения сводных (итоговых) таблиц с использованием PIVOT и UNPIVOT.

Обязательными к выполнению являются запросы, приведенные ниже (смотри свой вариант).
Отчет  по лабораторной работе предоставляется в виде  документа (Фамилия_Группа.docx). 
В этом  документе по каждому заданию необходимо представить: условие запроса, текст SQL-запроса, скрин-копию результата выполнения запроса.
Часть 2
Составить следующие запросы:
a)  Выбрать пациентов (ФИО), которые за последний месяц > 3 раз вызывали врача
b)  Выдать пациентов, ожидающих посещения врача (ФИО,адрес,участок,врач)
c)  По адресу пациента определить номер участка
d)  По дате и времени обращения определить примерное время посещения врача (предполагая, что на каждое посещение врач тратит 30 мин. и выход на вызова начинается с 12 ч.)
e)  Определить диагнозы, по которым превышен порог заболеваемости 10% (от общего количества вызовов) и выдать для каждого из них количество вызовов

Пример запроса: 
e)  Определить диагнозы, по которым превышен порог заболеваемости 10% (от общего количества вызовов) и выдать для каждого из них количество вызовов
![image](https://github.com/DJStArbuzz/PMI-3/blob/main/lab3/ex.png)

</h3>

# <img src="https://github.com/user-attachments/assets/e080adec-6af7-4bd2-b232-d43cb37024ac" width="20" height="20"/> Лабораторная работа №4


<p aligh="justify>
<h3>
  <a href="#client"></a>
Задание
Хранимые процедуры
Разработать 4 различных хранимых процедуры:

a) Процедура без параметров, формирующая список вызовов по каждому врачу на текущий день

b) Процедура, на входе получающая номер участка и формирующая список улиц, находящихся на этом участке

c) Процедура, на входе получающая номер участка, как выходной параметр выдает ФИО врача, обслуживающего данный участок

d) Процедура, находящая один из участков с максимальным количеством домов и возвращающая ФИО врача, обслуживающего данный участок (с использованием вызова предыдущей процедуры)

Пользовательские функции
Разработать 3 пользовательских функции:

a) Скалярная функция, возвращающая по адресу (улица, дом) номер участка

b) Inline-функция, возвращающая все вызовы, поступившие от заданного пациента за текущий год

c) Multi-statement-функция, возвращающая для заданного терапевта список пациентов, ожидающих его посещения в формате: ФИО пациента, адрес, примерное время посещения (из расчета, что на каждое посещение врач тратит 30 мин.)

Триггеры
Создать 3 триггера:

a) Триггер любого типа на добавление нового врача – если номер участка совпадает с номером какого-то другого врача, то вывод предупреждения и запись не добавляется

b) Последующий триггер на изменение диагноза посещения – если диагноз уже был выставлен, то его менять нельзя

c) Замещающий триггер на операцию отмены вызова – если врач еще не посетил этого пациента, то вызов можно отменить, в противном случае строка с этим вызовом не удаляется

![image](https://github.com/DJStArbuzz/PMI-3/blob/main/lab4/1.png)

![image](https://github.com/DJStArbuzz/PMI-3/blob/main/lab4/2.png)
# <img src="https://github.com/user-attachments/assets/e080adec-6af7-4bd2-b232-d43cb37024ac" width="20" height="20"/> Лабораторная работа №5

<p aligh="justify>
<h3>
  <a href="#client"></a>
Задание 1.
Для БД, созданной в Лаб.раб. 1-2, создать 2 роли. 
1-я роль должна иметь доступ к таблицам, хр. процедурам и др. объектам БД, требующийся для руководителя фирмы (зав. библиотекой, столовой, дет.садом, поликлиникой, ...) (т.е., ему д.б. разрешено просматривать конфиденциальную информацию, удалять, исправлять какие-то сведения, выполнять процедуры и функции). Некоторые права необходимо предоставить с возможностью дальнейшей передачи.

2-я роль должна иметь доступ, требующийся для простого сотрудника (просмотр не всей инф-ии, добавление, изменение, удаление – только того, что нужно для работы, выполнение ограниченного набора процедур и функции).
Включить 2-х пользователей, предварительно созданных для каждого студента администратором БД (User_<ваш логин>, User1_<ваш логин>, Пароль - 1234567),  в эти роли и проверить, что права ролей выполняются для каждого пользователя (для этого под каждым пользователем подключиться к БД).
Необходимо уметь предоставлять права на объекты любого типа, отзывать выданные права, давать полный запрет на выполнение некоторых действий. (через команды T-SQL и интерфейс SQL Server Management Studio (SSMS) )

Задание 2.
Выполнить маскирование некоторых поле Ваших таблиц  2-мя различными методами. 
1. ALTER COLUMN LastName ADD MASKED WITH (FUNCTION = 'partial(2,"xxxx",0)')
2. Используя механизмы представлений, хранимых процедур и функций.
Члены 1 роли должны видеть оригинальные данные, члены 2 роли маскированные.

# <img src="https://github.com/user-attachments/assets/e080adec-6af7-4bd2-b232-d43cb37024ac" width="20" height="20"/> Лабораторная работа №6

<p aligh="justify>
<h3>
  <a href="#client"></a>
</h3>
</p3>
Используйте реляционную БД из лабораторной работы №2.
Продумайте и создайте графовые таблицы по реляционной БД, заполните графовые таблицы используя данные в реляционных таблицах.
Напишите запросы из задания 3.2 используя паттерн MATCH.
Сравните полученные результаты  с  результатами запросов к реляционной модели. 

Отчет предоставить в виде:
1.	Схема узлов и ребер
2.	Скрипт для создания и заполнения графовых таблиц
3.	Запросы из задания 3.2 к двум моделям(реляционная, графовая.)




# <img src="https://github.com/user-attachments/assets/e080adec-6af7-4bd2-b232-d43cb37024ac" width="20" height="20"/> Лабораторная работа №7

<p aligh="justify>
<h3>
  <a href="#client"></a>
</h3>
</p3>
Цель работы
Используя данные базы данных, подготовленной в предыдущей лабораторной работе, подготовить и реализовать серию запросов, связанных с выборкой информации и модификацией данных таблиц.
Задание 1
Используя базу, полученную в лабораторной 2, создать транзакцию, произвести ее откат и фиксацию. Показать, что данные существовали до отката, удалились после отката, снова были добавлены, и затем были успешно зафиксированы. При необходимости используйте точки сохранения и вложенные транзакции.
Задание 2
Подготовить SQL-скрипты для выполнения проверок изолированности транзакций. Ваши скрипты должны работать с одной из таблиц, созданных в лабораторной работе №2.
Выполнение работы 
1.	Запустить клиента и соединиться с базой данных. Открыть второе окно для ввода текста запросов (Ctrl+N в первом окне). 
2.	 Установить в обоих сеансах уровень изоляции READ UNCOMMITTED. Выполнить сценарии проверки: 
	потерянных изменений,
	грязного чтения. 
3.	Записать протокол выполнения сценариев. 
4.	Установить в обоих сеансах уровень изоляции READ COMMITTED. Выполнить сценарии проверки: 
	грязного чтения. 
	неповторяющегося чтения. 
5.	 Записать протокол выполнения сценариев. 
6.	 Установить в обоих сеансах уровень изоляции REPEATABLE READ. Выполнить сценарии проверки: 
	неповторяющегося чтения, 
	фантома. 
7.	Записать протокол выполнения сценариев. 
8.	Установить в обоих сеансах уровень изоляции SERIALIZABLE. Выполнить сценария проверки 
	фантома. 
9.	Записать протокол выполнения сценария. 


Содержание отчета:
 Сценарий и протокол его выполнения.
 Краткие выводы о навыках, приобретенных в ходе выполнения работы. 



# <img src="https://github.com/user-attachments/assets/e080adec-6af7-4bd2-b232-d43cb37024ac" width="20" height="20"/> Лабораторная работа №8

<p aligh="justify>
<h3>
  <a href="#client"></a>
</h3>
</p3>
Задание 1
Выполните импорт коллекции из файла restaurants.json

Структура коллекции ресторанов
{
  "address": {
     «building»: «1007»,
     «coord»: [-73,856077, 40,848447],
     "street": "Моррис Парк Авеню",
     "zipcode": 10462
  },
  "borough": "Бронкс",
  "cuisine": "пекарня",
  "grades": [
     {"date": {"$ date": 1393804800000}, "grade": "A", "score": 2},
     {"date": {"$ date": 1378857600000}, "grade": "A", "score": 6},
     {"date": {"$ date": 1358985600000}, "grade": "A", "score": 10},
     {"date": {"$ date": 1322006400000}, "grade": "A", "score": 9},
     {"date": {"$ date": 1299715200000}, "grade": "B", "score": 14}
  ],
  "name": "Morris Park Bake Shop",
  "restaurant_id": "30075445"
}

Выполните запросы :
1.	Выведите все документы коллекции Ресторан в формате: restaurant_id, name, borough и cuisine, вывод  _id  для всех документов исключить.
2.	Выведите  первые 5 ресторанов в алфавитном порядке, которые находятся в районе Bronx.
3.	Найдите рестораны, которые набрали более 80, но менее 100 баллов.
4.	Найдите рестораны, которые не относятся к  типу кухни American, получили оценку «А», не расположены  в районе Brooklyn.  Документ должен отображаться в соответствии с кухней в порядке убывания.
5.	Найдите идентификатор ресторана, название, район и кухню для тех ресторанов, чье название начинается с первых трех букв назвали «Wil»
6.	Найдите  рестораны, которые относятся к району Bronx и готовят American  или Chinese блюда.
7.	Найдите идентификатор ресторана, название и оценки для тех ресторанов, которые  «2014-08-11T00: 00: 00Z» набрали 9 баллов за оценку А
8.	В каждом районе посчитайте количество ресторанов по каждому виду кухни. Документ должен иметь формат  borough, cuisine, count 
9.	В  районе Bronx найдите ресторан с минимальной суммой набранных баллов.
10.	 Добавьте в коллекцию свой любимый ресторан.
11.	 В добавленном ресторане укажите информацию о времени его работы.
12.	 Измените время работы вашего любимого ресторана.


Задание 2 
Выполните импорт коллекции из файла weather.json

Структура коллекции Погода
{
    "year": 2014,
    "month": 1,
    "day": 1,
    "hour": 0,
    "temperature": -1,
    "wind_direction": "Южный",
    "wind": "3",
    "code": "CL",
    "clouds": 9,
    "visibility": 10,
    "humidity": 94,
    "pressure": 1030
  }
Выполните запросы с использованием Aggregate:
1. Какова разница между максимальной и минимальной температурой в течение года? 
2. Какова средняя температура в году, если исключить 10 дней с самой низкой температурой и 10 дней с самой высокой?
3. Найти первые 10 записей с самой низкой погодой, когда дул ветер с юга и посчитайте  среднюю температуры для этих записей
4. Подсчитайте количество дней, когда шел снег. (Будем считать снегом осадки, которые выпали,  когда температура была ниже нуля)
5. В течение зимы иногда шел снег, а иногда дождь. Насколько больше (или меньше) выпало осадков в виде снега.
6. Какова вероятность того что в ясный день выпадут осадки? (Предположим, что день считается ясным, если ясная погода фиксируется более чем в 75% случаев)
7. Увеличьте температуру на один градус при каждом измерении в нечетный день во время зимы.  На сколько градусов изменилась средняя температура?



</p3>
